{"dependencies":[{"name":"./ExpoUpdates","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":46,"index":46}}],"key":"xvfiwKXsFVvB05bziLrxffeS3bo=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"latestContext\", {\n    enumerable: true,\n    get: function () {\n      return latestContext;\n    }\n  });\n  Object.defineProperty(exports, \"addUpdatesStateChangeListener\", {\n    enumerable: true,\n    get: function () {\n      return addUpdatesStateChangeListener;\n    }\n  });\n  Object.defineProperty(exports, \"emitTestStateChangeEvent\", {\n    enumerable: true,\n    get: function () {\n      return emitTestStateChangeEvent;\n    }\n  });\n  Object.defineProperty(exports, \"resetLatestContext\", {\n    enumerable: true,\n    get: function () {\n      return resetLatestContext;\n    }\n  });\n  var _ExpoUpdates = require(_dependencyMap[0], \"./ExpoUpdates\");\n  var ExpoUpdatesModule = _interopDefault(_ExpoUpdates);\n  let latestContext = transformNativeStateMachineContext(ExpoUpdatesModule.default.initialContext);\n  ExpoUpdatesModule.default.addListener('Expo.nativeUpdatesStateChangeEvent', _handleNativeStateChangeEvent);\n  const _updatesStateChangeListeners = new Set();\n  // Reemits native state change events\n  function _handleNativeStateChangeEvent(params) {\n    const newParams = typeof params === 'string' ? JSON.parse(params) : Object.assign({}, params);\n    const transformedContext = transformNativeStateMachineContext(newParams.context);\n    // only process state change events if they are in order\n    if (transformedContext.sequenceNumber <= latestContext.sequenceNumber) {\n      return;\n    }\n    newParams.context = transformedContext;\n    latestContext = transformedContext;\n    _updatesStateChangeListeners.forEach(listener => listener(newParams));\n  }\n  /**\n   * Add listener for state change events\n   * @hidden\n   */\n  const addUpdatesStateChangeListener = listener => {\n    _updatesStateChangeListeners.add(listener);\n    return {\n      remove() {\n        _updatesStateChangeListeners.delete(listener);\n      }\n    };\n  };\n  /**\n   * Allows JS test to emit a simulated native state change event (used in unit testing)\n   * @hidden\n   */\n  const emitTestStateChangeEvent = event => {\n    _handleNativeStateChangeEvent(event);\n  };\n  /**\n   * Allows JS test to reset latest context (and sequence number)\n   * @hidden\n   */\n  const resetLatestContext = () => {\n    latestContext = transformNativeStateMachineContext(ExpoUpdatesModule.default.initialContext);\n  };\n  function transformNativeStateMachineContext(originalNativeContext) {\n    const nativeContext = Object.assign({}, originalNativeContext);\n    if (nativeContext.latestManifestString) {\n      nativeContext.latestManifest = JSON.parse(nativeContext.latestManifestString);\n      delete nativeContext.latestManifestString;\n    }\n    if (nativeContext.downloadedManifestString) {\n      nativeContext.downloadedManifest = JSON.parse(nativeContext.downloadedManifestString);\n      delete nativeContext.downloadedManifestString;\n    }\n    if (nativeContext.lastCheckForUpdateTimeString) {\n      nativeContext.lastCheckForUpdateTime = new Date(nativeContext.lastCheckForUpdateTimeString);\n      delete nativeContext.lastCheckForUpdateTimeString;\n    }\n    if (nativeContext.rollbackString) {\n      nativeContext.rollback = JSON.parse(nativeContext.rollbackString);\n      delete nativeContext.rollbackString;\n    }\n    return nativeContext;\n  }\n});","lineCount":99,"map":[[12,2,2,0,"Object"],[12,8,2,0],[12,9,2,0,"defineProperty"],[12,23,2,0],[12,24,2,0,"exports"],[12,31,2,0],[13,4,2,0,"enumerable"],[13,14,2,0],[14,4,2,0,"get"],[14,7,2,0],[14,18,2,0,"get"],[14,19,2,0],[15,6,2,0],[15,13,2,0,"latestContext"],[15,26,2,0],[16,4,2,0],[17,2,2,0],[18,2,21,0,"Object"],[18,8,21,0],[18,9,21,0,"defineProperty"],[18,23,21,0],[18,24,21,0,"exports"],[18,31,21,0],[19,4,21,0,"enumerable"],[19,14,21,0],[20,4,21,0,"get"],[20,7,21,0],[20,18,21,0,"get"],[20,19,21,0],[21,6,21,0],[21,13,21,0,"addUpdatesStateChangeListener"],[21,42,21,0],[22,4,21,0],[23,2,21,0],[24,2,33,0,"Object"],[24,8,33,0],[24,9,33,0,"defineProperty"],[24,23,33,0],[24,24,33,0,"exports"],[24,31,33,0],[25,4,33,0,"enumerable"],[25,14,33,0],[26,4,33,0,"get"],[26,7,33,0],[26,18,33,0,"get"],[26,19,33,0],[27,6,33,0],[27,13,33,0,"emitTestStateChangeEvent"],[27,37,33,0],[28,4,33,0],[29,2,33,0],[30,2,40,0,"Object"],[30,8,40,0],[30,9,40,0,"defineProperty"],[30,23,40,0],[30,24,40,0,"exports"],[30,31,40,0],[31,4,40,0,"enumerable"],[31,14,40,0],[32,4,40,0,"get"],[32,7,40,0],[32,18,40,0,"get"],[32,19,40,0],[33,6,40,0],[33,13,40,0,"resetLatestContext"],[33,31,40,0],[34,4,40,0],[35,2,40,0],[36,2,1,0],[36,6,1,0,"_ExpoUpdates"],[36,18,1,0],[36,21,1,0,"require"],[36,28,1,0],[36,29,1,0,"_dependencyMap"],[36,43,1,0],[37,2,1,0],[37,6,1,0,"ExpoUpdatesModule"],[37,23,1,0],[37,26,1,0,"_interopDefault"],[37,41,1,0],[37,42,1,0,"_ExpoUpdates"],[37,54,1,0],[38,2,2,7],[38,6,2,11,"latestContext"],[38,19,2,24],[38,22,2,27,"transformNativeStateMachineContext"],[38,56,2,61],[38,57,2,62,"ExpoUpdatesModule"],[38,74,2,79],[38,75,2,79,"default"],[38,82,2,79],[38,83,2,80,"initialContext"],[38,97,2,94],[38,98,2,95],[39,2,3,0,"ExpoUpdatesModule"],[39,19,3,17],[39,20,3,17,"default"],[39,27,3,17],[39,28,3,18,"addListener"],[39,39,3,29],[39,40,3,30],[39,76,3,66],[39,78,3,68,"_handleNativeStateChangeEvent"],[39,107,3,97],[39,108,3,98],[40,2,4,0],[40,8,4,6,"_updatesStateChangeListeners"],[40,36,4,34],[40,39,4,37],[40,43,4,41,"Set"],[40,46,4,44],[40,47,4,45],[40,48,4,46],[41,2,5,0],[42,2,6,0],[42,11,6,9,"_handleNativeStateChangeEvent"],[42,40,6,38,"_handleNativeStateChangeEvent"],[42,41,6,39,"params"],[42,47,6,45],[42,49,6,47],[43,4,7,4],[43,10,7,10,"newParams"],[43,19,7,19],[43,22,7,22],[43,29,7,29,"params"],[43,35,7,35],[43,40,7,40],[43,48,7,48],[43,51,7,51,"JSON"],[43,55,7,55],[43,56,7,56,"parse"],[43,61,7,61],[43,62,7,62,"params"],[43,68,7,68],[43,69,7,69],[43,72,7,69,"Object"],[43,78,7,69],[43,79,7,69,"assign"],[43,85,7,69],[43,90,7,77,"params"],[43,96,7,83],[43,97,7,85],[44,4,8,4],[44,10,8,10,"transformedContext"],[44,28,8,28],[44,31,8,31,"transformNativeStateMachineContext"],[44,65,8,65],[44,66,8,66,"newParams"],[44,75,8,75],[44,76,8,76,"context"],[44,83,8,83],[44,84,8,84],[45,4,9,4],[46,4,10,4],[46,8,10,8,"transformedContext"],[46,26,10,26],[46,27,10,27,"sequenceNumber"],[46,41,10,41],[46,45,10,45,"latestContext"],[46,58,10,58],[46,59,10,59,"sequenceNumber"],[46,73,10,73],[46,75,10,75],[47,6,11,8],[48,4,12,4],[49,4,13,4,"newParams"],[49,13,13,13],[49,14,13,14,"context"],[49,21,13,21],[49,24,13,24,"transformedContext"],[49,42,13,42],[50,4,14,4,"latestContext"],[50,17,14,17],[50,20,14,20,"transformedContext"],[50,38,14,38],[51,4,15,4,"_updatesStateChangeListeners"],[51,32,15,32],[51,33,15,33,"forEach"],[51,40,15,40],[51,41,15,42,"listener"],[51,49,15,50],[51,53,15,55,"listener"],[51,61,15,63],[51,62,15,64,"newParams"],[51,71,15,73],[51,72,15,74],[51,73,15,75],[52,2,16,0],[53,2,17,0],[54,0,18,0],[55,0,19,0],[56,0,20,0],[57,2,21,7],[57,8,21,13,"addUpdatesStateChangeListener"],[57,37,21,42],[57,40,21,46,"listener"],[57,48,21,54],[57,52,21,59],[58,4,22,4,"_updatesStateChangeListeners"],[58,32,22,32],[58,33,22,33,"add"],[58,36,22,36],[58,37,22,37,"listener"],[58,45,22,45],[58,46,22,46],[59,4,23,4],[59,11,23,11],[60,6,24,8,"remove"],[60,12,24,14,"remove"],[60,13,24,14],[60,15,24,17],[61,8,25,12,"_updatesStateChangeListeners"],[61,36,25,40],[61,37,25,41,"delete"],[61,43,25,47],[61,44,25,48,"listener"],[61,52,25,56],[61,53,25,57],[62,6,26,8],[63,4,27,4],[63,5,27,5],[64,2,28,0],[64,3,28,1],[65,2,29,0],[66,0,30,0],[67,0,31,0],[68,0,32,0],[69,2,33,7],[69,8,33,13,"emitTestStateChangeEvent"],[69,32,33,37],[69,35,33,41,"event"],[69,40,33,46],[69,44,33,51],[70,4,34,4,"_handleNativeStateChangeEvent"],[70,33,34,33],[70,34,34,34,"event"],[70,39,34,39],[70,40,34,40],[71,2,35,0],[71,3,35,1],[72,2,36,0],[73,0,37,0],[74,0,38,0],[75,0,39,0],[76,2,40,7],[76,8,40,13,"resetLatestContext"],[76,26,40,31],[76,29,40,34,"resetLatestContext"],[76,30,40,34],[76,35,40,40],[77,4,41,4,"latestContext"],[77,17,41,17],[77,20,41,20,"transformNativeStateMachineContext"],[77,54,41,54],[77,55,41,55,"ExpoUpdatesModule"],[77,72,41,72],[77,73,41,72,"default"],[77,80,41,72],[77,81,41,73,"initialContext"],[77,95,41,87],[77,96,41,88],[78,2,42,0],[78,3,42,1],[79,2,43,0],[79,11,43,9,"transformNativeStateMachineContext"],[79,45,43,43,"transformNativeStateMachineContext"],[79,46,43,44,"originalNativeContext"],[79,67,43,65],[79,69,43,67],[80,4,44,4],[80,10,44,10,"nativeContext"],[80,23,44,23],[80,26,44,23,"Object"],[80,32,44,23],[80,33,44,23,"assign"],[80,39,44,23],[80,44,44,31,"originalNativeContext"],[80,65,44,52],[80,66,44,54],[81,4,45,4],[81,8,45,8,"nativeContext"],[81,21,45,21],[81,22,45,22,"latestManifestString"],[81,42,45,42],[81,44,45,44],[82,6,46,8,"nativeContext"],[82,19,46,21],[82,20,46,22,"latestManifest"],[82,34,46,36],[82,37,46,39,"JSON"],[82,41,46,43],[82,42,46,44,"parse"],[82,47,46,49],[82,48,46,50,"nativeContext"],[82,61,46,63],[82,62,46,64,"latestManifestString"],[82,82,46,84],[82,83,46,85],[83,6,47,8],[83,13,47,15,"nativeContext"],[83,26,47,28],[83,27,47,29,"latestManifestString"],[83,47,47,49],[84,4,48,4],[85,4,49,4],[85,8,49,8,"nativeContext"],[85,21,49,21],[85,22,49,22,"downloadedManifestString"],[85,46,49,46],[85,48,49,48],[86,6,50,8,"nativeContext"],[86,19,50,21],[86,20,50,22,"downloadedManifest"],[86,38,50,40],[86,41,50,43,"JSON"],[86,45,50,47],[86,46,50,48,"parse"],[86,51,50,53],[86,52,50,54,"nativeContext"],[86,65,50,67],[86,66,50,68,"downloadedManifestString"],[86,90,50,92],[86,91,50,93],[87,6,51,8],[87,13,51,15,"nativeContext"],[87,26,51,28],[87,27,51,29,"downloadedManifestString"],[87,51,51,53],[88,4,52,4],[89,4,53,4],[89,8,53,8,"nativeContext"],[89,21,53,21],[89,22,53,22,"lastCheckForUpdateTimeString"],[89,50,53,50],[89,52,53,52],[90,6,54,8,"nativeContext"],[90,19,54,21],[90,20,54,22,"lastCheckForUpdateTime"],[90,42,54,44],[90,45,54,47],[90,49,54,51,"Date"],[90,53,54,55],[90,54,54,56,"nativeContext"],[90,67,54,69],[90,68,54,70,"lastCheckForUpdateTimeString"],[90,96,54,98],[90,97,54,99],[91,6,55,8],[91,13,55,15,"nativeContext"],[91,26,55,28],[91,27,55,29,"lastCheckForUpdateTimeString"],[91,55,55,57],[92,4,56,4],[93,4,57,4],[93,8,57,8,"nativeContext"],[93,21,57,21],[93,22,57,22,"rollbackString"],[93,36,57,36],[93,38,57,38],[94,6,58,8,"nativeContext"],[94,19,58,21],[94,20,58,22,"rollback"],[94,28,58,30],[94,31,58,33,"JSON"],[94,35,58,37],[94,36,58,38,"parse"],[94,41,58,43],[94,42,58,44,"nativeContext"],[94,55,58,57],[94,56,58,58,"rollbackString"],[94,70,58,72],[94,71,58,73],[95,6,59,8],[95,13,59,15,"nativeContext"],[95,26,59,28],[95,27,59,29,"rollbackString"],[95,41,59,43],[96,4,60,4],[97,4,61,4],[97,11,61,11,"nativeContext"],[97,24,61,24],[98,2,62,0],[99,0,62,1],[99,3]],"functionMap":{"names":["<global>","_handleNativeStateChangeEvent","_updatesStateChangeListeners.forEach$argument_0","addUpdatesStateChangeListener","remove","emitTestStateChangeEvent","resetLatestContext","transformNativeStateMachineContext"],"mappings":"AAA;ACK;yCCS,iCD;CDC;6CGK;QCG;SDE;CHE;wCKK;CLE;kCMK;CNE;AOC;CPmB"},"hasCjsExports":false},"type":"js/module"}]}